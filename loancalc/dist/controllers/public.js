"use strict";var __decorate=this&&this.__decorate||function(a,b,e,f){var g,d=arguments.length,c=3>d?b:null===f?f=Object.getOwnPropertyDescriptor(b,e):f;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(a,b,e,f);else for(var h=a.length-1;0<=h;h--)(g=a[h])&&(c=(3>d?g(c):3<d?g(b,e,c):g(b,e))||c);return 3<d&&c&&Object.defineProperty(b,e,c),c},__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const serve_1=require("../serve"),send=require("koa-send"),staticFileOptions={root:"./static",maxage:3e4,hidden:!1,gzip:!0},uploadedStaticFileOptions={root:"./protected/uploads",maxage:3e4,hidden:!1,gzip:!0};class PublicController extends serve_1.Controller{getPublic({reroute:a,params:b}){return __awaiter(this,void 0,void 0,function*(){const c=b.getString("resource");a.path="/static/"+c})}getStatic({context:a,params:b}){return __awaiter(this,void 0,void 0,function*(){const c=b.getString("resource"),{response:d}=a;try{yield send(a,c,staticFileOptions)}catch(a){d.status=a.status||500}})}getUpload({context:a,params:b}){return __awaiter(this,void 0,void 0,function*(){const c=b.getString("resource"),{response:d}=a;try{yield send(a,c,uploadedStaticFileOptions)}catch(a){d.status=a.status||500}})}getDashboardStatic({reroute:a}){return __awaiter(this,void 0,void 0,function*(){a.path="/static/dash/index.html"})}getCalculatorStaticResource({reroute:a,params:b}){return __awaiter(this,void 0,void 0,function*(){const c=b.getString("resource");a.path="/static/calc/"+c})}getDashboardStaticResource({reroute:a,params:b}){return __awaiter(this,void 0,void 0,function*(){const c=b.getString("resource");a.path="/static/dash/"+c})}}__decorate([serve_1.get("/public/:resource(.+)")],PublicController.prototype,"getPublic",null),__decorate([serve_1.get("/static/:resource(.+)")],PublicController.prototype,"getStatic",null),__decorate([serve_1.get("/ustatic/:resource(.+)")],PublicController.prototype,"getUpload",null),__decorate([serve_1.get("/dashboard")],PublicController.prototype,"getDashboardStatic",null),__decorate([serve_1.get("/scalc/:resource(.+)")],PublicController.prototype,"getCalculatorStaticResource",null),__decorate([serve_1.get("/sdash/:resource(.+)")],PublicController.prototype,"getDashboardStaticResource",null),exports.default=PublicController;